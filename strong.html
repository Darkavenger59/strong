<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Strong Clone Tracker</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        background: '#0f172a', // Slate 900
                        surface: '#1e293b',    // Slate 800
                        primary: '#3b82f6',    // Blue 500
                        success: '#22c55e',    // Green 500
                        danger: '#ef4444',     // Red 500
                    },
                    animation: {
                        'slide-up': 'slideUp 0.3s ease-out forwards',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        slideUp: {
                            '0%': { transform: 'translateY(100%)' },
                            '100%': { transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { background-color: #0f172a; color: #f3f4f6; }
        /* Masquer les flèches des inputs number */
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Composant Icône simple (wrapper pour Lucide)
        const Icon = ({ name, size = 20, className = "" }) => {
            useEffect(() => {
                lucide.createIcons();
            });
            return <i data-lucide={name} width={size} height={size} className={className}></i>;
        };

        const App = () => {
            // --- ÉTATS ---
            const [screen, setScreen] = useState('workout'); // 'workout' ou 'summary'
            const [duration, setDuration] = useState(0);
            
            // Timer de repos
            const [restTimer, setRestTimer] = useState(90);
            const [isResting, setIsResting] = useState(false);

            // Données de la séance
            const [workout, setWorkout] = useState({
                title: "Push Day (Pecs/Triceps)",
                exercises: [
                    {
                        id: 1,
                        name: "Développé Couché",
                        sets: [
                            { id: 101, weight: 80, reps: 8, completed: true },
                            { id: 102, weight: 80, reps: 8, completed: false },
                            { id: 103, weight: 80, reps: 8, completed: false }
                        ]
                    },
                    {
                        id: 2,
                        name: "Écarté Poulie",
                        sets: [
                            { id: 201, weight: 25, reps: 12, completed: false },
                            { id: 202, weight: 25, reps: 12, completed: false }
                        ]
                    }
                ]
            });

            // --- EFFETS ---
            
            // Chronomètre global de la séance
            useEffect(() => {
                if(screen !== 'workout') return;
                const timer = setInterval(() => setDuration(d => d + 1), 1000);
                return () => clearInterval(timer);
            }, [screen]);

            // Chronomètre de repos
            useEffect(() => {
                let interval = null;
                if (isResting && restTimer > 0) {
                    interval = setInterval(() => setRestTimer(t => t - 1), 1000);
                } else if (restTimer === 0) {
                    setIsResting(false);
                }
                return () => clearInterval(interval);
            }, [isResting, restTimer]);

            // Mettre à jour les icônes après chaque rendu
            useEffect(() => {
                lucide.createIcons();
            });

            // --- FONCTIONS ---

            const formatTime = (sec) => {
                const m = Math.floor(sec / 60).toString().padStart(2, '0');
                const s = (sec % 60).toString().padStart(2, '0');
                return `${m}:${s}`;
            };

            const toggleSet = (exIndex, setIndex) => {
                const newWorkout = { ...workout };
                const set = newWorkout.exercises[exIndex].sets[setIndex];
                set.completed = !set.completed;
                setWorkout(newWorkout);

                if (set.completed) {
                    setRestTimer(90); // Reset à 1m30
                    setIsResting(true);
                }
            };

            const addSet = (exIndex) => {
                const newWorkout = { ...workout };
                const prevSet = newWorkout.exercises[exIndex].sets.slice(-1)[0];
                newWorkout.exercises[exIndex].sets.push({
                    id: Date.now(),
                    weight: prevSet ? prevSet.weight : 0,
                    reps: prevSet ? prevSet.reps : 0,
                    completed: false
                });
                setWorkout(newWorkout);
            };

            const updateVal = (exIdx, setIdx, field, val) => {
                const newWorkout = { ...workout };
                newWorkout.exercises[exIdx].sets[setIdx][field] = val;
                setWorkout(newWorkout);
            };

            const finishWorkout = () => {
                setIsResting(false);
                setScreen('summary');
            };

            const calculateVolume = () => {
                let vol = 0;
                workout.exercises.forEach(ex => {
                    ex.sets.forEach(s => {
                        if(s.completed) vol += (s.weight * s.reps);
                    });
                });
                return vol;
            };

            const calculateSets = () => {
                let count = 0;
                workout.exercises.forEach(ex => ex.sets.forEach(s => { if(s.completed) count++ }));
                return count;
            };

            // --- RENDER ---

            if (screen === 'summary') {
                return (
                    <div className="min-h-screen bg-background flex flex-col items-center justify-center p-6 animate-slide-up">
                        <div className="bg-surface w-full max-w-md rounded-2xl p-8 shadow-2xl border border-slate-700 text-center">
                            <div className="w-20 h-20 bg-green-500/20 text-success rounded-full flex items-center justify-center mx-auto mb-6">
                                <Icon name="trophy" size={40} />
                            </div>
                            <h2 className="text-3xl font-bold text-white mb-2">Terminé !</h2>
                            <p className="text-gray-400 mb-8">Super séance. Voici tes chiffres.</p>

                            <div className="grid grid-cols-2 gap-4 mb-8">
                                <div className="bg-background p-4 rounded-xl border border-slate-700">
                                    <div className="text-gray-400 text-[10px] uppercase font-bold mb-1">Durée</div>
                                    <div className="text-xl font-mono font-bold text-white">{formatTime(duration)}</div>
                                </div>
                                <div className="bg-background p-4 rounded-xl border border-slate-700">
                                    <div className="text-gray-400 text-[10px] uppercase font-bold mb-1">Volume</div>
                                    <div className="text-xl font-mono font-bold text-primary">{calculateVolume()} <span className="text-sm text-gray-500">kg</span></div>
                                </div>
                                <div className="bg-background p-4 rounded-xl border border-slate-700">
                                    <div className="text-gray-400 text-[10px] uppercase font-bold mb-1">Séries</div>
                                    <div className="text-xl font-mono font-bold text-white">{calculateSets()}</div>
                                </div>
                                <div className="bg-background p-4 rounded-xl border border-slate-700">
                                    <div className="text-gray-400 text-[10px] uppercase font-bold mb-1">Records</div>
                                    <div className="text-xl font-mono font-bold text-yellow-500">2</div>
                                </div>
                            </div>

                            <button onClick={() => window.location.reload()} className="w-full py-3 bg-primary hover:bg-blue-600 text-white rounded-lg font-bold uppercase tracking-wider shadow-lg shadow-blue-900/20">
                                Nouvelle Séance
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="pb-32 min-h-screen">
                    {/* HEADER */}
                    <header className="bg-surface px-4 py-3 flex justify-between items-center sticky top-0 z-20 shadow-md border-b border-slate-700/50">
                        <div>
                            <h1 className="font-bold text-white tracking-wide">{workout.title}</h1>
                            <div className="text-xs text-gray-400 flex items-center gap-1 mt-0.5">
                                <Icon name="timer" size={12} /> <span>{formatTime(duration)}</span>
                            </div>
                        </div>
                        <button onClick={finishWorkout} className="bg-primary hover:bg-blue-600 active:scale-95 transition-transform text-white px-4 py-1.5 rounded font-bold text-xs uppercase tracking-wider">
                            Terminer
                        </button>
                    </header>

                    {/* LISTE EXERCICES */}
                    <div className="p-3 max-w-2xl mx-auto space-y-4 mt-2">
                        {workout.exercises.map((ex, exIdx) => (
                            <div key={ex.id} className="bg-surface rounded-xl shadow-sm overflow-hidden border border-slate-700/30">
                                {/* Header Ex */}
                                <div className="p-3 flex justify-between items-center border-b border-slate-700/50 bg-slate-800/50">
                                    <h2 className="font-bold text-blue-400 text-lg tracking-tight">{ex.name}</h2>
                                    <Icon name="more-horizontal" className="text-gray-500" />
                                </div>

                                {/* Titres Colonnes */}
                                <div className="grid grid-cols-10 gap-2 px-2 py-2 text-[10px] text-gray-500 font-extrabold text-center uppercase tracking-wider bg-surface">
                                    <div className="col-span-1">Set</div>
                                    <div className="col-span-3">kg</div>
                                    <div className="col-span-3">Reps</div>
                                    <div className="col-span-3">Valider</div>
                                </div>

                                {/* Liste Sets */}
                                <div className="flex flex-col gap-1 px-2 pb-3 bg-surface">
                                    {ex.sets.map((set, setIdx) => (
                                        <div key={set.id} className={`grid grid-cols-10 gap-2 items-center h-10 rounded transition-colors duration-300 ${set.completed ? 'bg-green-500/10' : ''}`}>
                                            <div className="col-span-1 flex justify-center">
                                                <div className={`w-6 h-6 rounded flex items-center justify-center text-xs font-bold ${set.completed ? 'text-success' : 'bg-slate-700 text-gray-400'}`}>
                                                    {setIdx + 1}
                                                </div>
                                            </div>
                                            
                                            <div className="col-span-3">
                                                <input 
                                                    type="number" 
                                                    value={set.weight} 
                                                    onChange={(e) => updateVal(exIdx, setIdx, 'weight', e.target.value)}
                                                    className={`w-full text-center bg-transparent font-bold text-lg outline-none border-b border-transparent focus:border-primary focus:bg-slate-700/50 rounded ${set.completed ? 'text-gray-500' : 'text-white'}`}
                                                />
                                            </div>

                                            <div className="col-span-3">
                                                <input 
                                                    type="number" 
                                                    value={set.reps} 
                                                    onChange={(e) => updateVal(exIdx, setIdx, 'reps', e.target.value)}
                                                    className={`w-full text-center bg-transparent font-bold text-lg outline-none border-b border-transparent focus:border-primary focus:bg-slate-700/50 rounded ${set.completed ? 'text-gray-500' : 'text-white'}`}
                                                />
                                            </div>

                                            <div className="col-span-3 flex justify-center">
                                                <button 
                                                    onClick={() => toggleSet(exIdx, setIdx)}
                                                    className={`w-full h-8 rounded flex items-center justify-center transition-all active:scale-95 ${set.completed ? 'bg-success text-white shadow-[0_0_15px_rgba(34,197,94,0.3)]' : 'bg-slate-700 text-gray-400 hover:bg-slate-600'}`}
                                                >
                                                    <Icon name="check" size={18} className={set.completed ? "stroke-[3]" : ""} />
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                                
                                <button onClick={() => addSet(exIdx)} className="w-full py-3 bg-slate-800 hover:bg-slate-700 text-blue-400 font-bold text-[10px] uppercase tracking-widest flex items-center justify-center gap-2 border-t border-slate-700/50">
                                    <Icon name="plus" size={14} /> Ajouter Série
                                </button>
                            </div>
                        ))}

                        <button className="w-full py-4 rounded-xl border-2 border-dashed border-slate-600 text-slate-500 font-bold uppercase hover:border-primary hover:text-primary hover:bg-slate-800/50 transition-all">
                            Ajouter un exercice
                        </button>
                    </div>

                    {/* REST TIMER BAR */}
                    {isResting && (
                        <div className="fixed bottom-0 left-0 w-full bg-surface border-t border-slate-700 p-3 shadow-[0_-4px_30px_rgba(0,0,0,0.6)] z-50 animate-slide-up">
                            <div className="max-w-2xl mx-auto flex justify-between items-center">
                                <div className="flex items-center gap-3">
                                    <div className="p-2 bg-slate-700 rounded-full text-blue-400 animate-pulse-slow">
                                        <Icon name="clock" size={20} />
                                    </div>
                                    <div>
                                        <div className="text-[10px] text-gray-400 uppercase font-bold tracking-wider">Repos</div>
                                        <div className="text-xl font-mono font-bold text-white tracking-wider">{formatTime(restTimer)}</div>
                                    </div>
                                </div>
                                <div className="flex gap-2">
                                    <button onClick={() => setRestTimer(t => t + 30)} className="px-3 py-2 bg-slate-700 rounded text-xs font-bold hover:bg-slate-600 text-white">+30s</button>
                                    <button onClick={() => setIsResting(false)} className="px-3 py-2 bg-red-500/10 text-red-400 border border-red-500/20 rounded text-xs font-bold hover:bg-red-500/20">Stop</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
                             
